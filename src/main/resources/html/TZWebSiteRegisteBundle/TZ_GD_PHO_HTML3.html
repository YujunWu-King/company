<!DOCTYPE html>
<html data-dpr="1" style="font-size: 23.4375px;">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta charset="utf-8">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=0">
<title></title>
<link href="%bind(:20)/statics/css/appeditor/m/style.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="%bind(:20)/statics/css/appeditor/m/LCalendar.css">
<link rel="stylesheet" href="%bind(:20)/statics/css/appeditor/m/rest.css">
<script type="text/javascript" src="%bind(:20)/statics/js/lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="%bind(:20)/statics/js/lib/jquery/jquery.form.js"></script>
<link rel="stylesheet" href="%bind(:20)/statics/css/appeditor/m/swiper.min.css">
<script type="text/javascript" src="%bind(:20)/statics/js/tranzvision/appwidget/m/rem.js"></script>
<script type="text/javascript" src="%bind(:20)/statics/js/tranzvision/appwidget/m/common.js"></script>
<script src="%bind(:20)/statics/js/tranzvision/appwidget/m/swiper.min.js"></script>
<script src="%bind(:20)/statics/js/tranzvision/appwidget/m/LCalendar.js"></script> 
<script src="%bind(:20)/statics/js/tranzvision/appwidget/m/iscroll-zoom.js"></script>
<script src="%bind(:20)/statics/js/tranzvision/appwidget/m/hammer.js"></script>
<script src="%bind(:20)/statics/js/tranzvision/appwidget/m/jquery.photoClip.js"></script>
<script>
var wid=$(window).width()*0.9
// alert(wid);
var obUrl = ''
//document.addEventListener('touchmove', function (e) { e.preventDefault(); }, false);
$("#clipArea").photoClip({
	width:wid,
	height:wid,
	file: "#file",
	view: "#view",
	ok: "#clipBtn",
	loadStart: function() {
		console.log("照片读取中");
	},
	loadComplete: function() {
		console.log("照片读取完成");
	},
	clipFinish: function(dataURL) {
		//console.log(dataURL);
	}
});



$(function(){
$("#clipBtn").click(function(){
	     var imaPath="";
		$("#photox").empty();
		$('#photox').append('<img src="' + imgsource + '" align="absmiddle" >');
		$(".htmleaf-container").hide();
		var obj_file = document.getElementById("file");
		console.log(obj_file.value);
		
		
		$("#myupload").ajaxSubmit({
			dataType:  "json",
			success: function(msg) {
				
				//console.log(msg);
				imaPath=msg.msg.accessPath+msg.msg.sysFileName;
				console.log("imaPath"+imaPath);
			    var filename=$("#photox img").attr("src");
				var filedate=filename.split(',');
				//console.log("filedate[1]"+filedate[1]);
		        
		        
		  // console.log(filename);
			    var fileStrJson = { "imageDate": filedate[1], "imaPath": imaPath};
			  
			    var tzParams = '{"ComID":"TZ_ONLINE_REG_COM","PageID":"TZ_MUP_PHOTO_STD","OperateType":"QF","comParams":' + JSON.stringify( fileStrJson ) + '}';
			   // console.log("tzParams"+tzParams);
			$.ajax({
			    type:"POST",
			    url:TzUniversityContextPath + "/dispatcher",
				dataType:"json",
			    data: {"tzParams" : tzParams },	
			    success:function(html){
			    	
			    }
			})
		   }
	     })
	
  })
});


$(function(){
	jQuery.divselect = function(divselectid,inputselectid) {
		var inputselect = $(inputselectid);
		$(divselectid+" small").click(function(){
			$("#divselect ul").toggle();
			$(".mask").show();
		});
		$(divselectid+" ul li a").click(function(){
			var txt = $(this).text();
			$(divselectid+" small").html(txt);
			var value = $(this).attr("selectid");
			inputselect.val(value);
			$(divselectid+" ul").hide();
			$(".mask").hide();
			$("#divselect small").css("color","#333")
		});
	};
	$.divselect("#divselect","#inputselect");
});


$(function(){
	jQuery.divselectx = function(divselectxid,inputselectxid) {
		var inputselectx = $(inputselectxid);
		$(divselectxid+" small").click(function(){
			$("#divselectx ul").toggle();
			$(".mask").show();
		});
		$(divselectxid+" ul li a").click(function(){
			var txt = $(this).text();
			$(divselectxid+" small").html(txt);
			var value = $(this).attr("selectidx");
			inputselectx.val(value);
			$(divselectxid+" ul").hide();
			$(".mask").hide();
			$("#divselectx small").css("color","#333")
		});
	};
	$.divselectx("#divselectx","#inputselectx");
});


$(function(){
	jQuery.divselecty = function(divselectyid,inputselectyid) {
		var inputselecty = $(inputselectyid);
		$(divselectyid+" small").click(function(){
			$("#divselecty ul").toggle();
			$(".mask").show();
		});
		$(divselectyid+" ul li a").click(function(){
			var txt = $(this).text();
			$(divselectyid+" small").html(txt);
			var value = $(this).attr("selectyid");
			inputselecty.val(value);
			$(divselectyid+" ul").hide();
			$(".mask").hide();
			$("#divselecty small").css("color","#333")
		});
	};
	$.divselecty("#divselecty","#inputselecty");
});


$(function(){
   $(".mask").click(function(){
	   $(".mask").hide();
	   $(".all").hide();
   })
	$(".right input").blur(function () {
		if ($.trim($(this).val()) == '') {
			$(this).addClass("place").html();
		}
		else {
			$(this).removeClass("place");
		}
	})
});


$("#file0").change(function(){
	var objUrl = getObjectURL(this.files[0]) ;
	 obUrl = objUrl;
	console.log("objUrl = "+objUrl) ;
	if (objUrl) {
		$("#img0").attr("src", objUrl).show();
	}
	else{
		$("#img0").hide();
	}
}) ;
function qd(){
   var objUrl = getObjectURL(this.files[0]) ;
   obUrl = objUrl;
   console.log("objUrl = "+objUrl) ;
   if (objUrl) {
	   $("#img0").attr("src", objUrl).show();
   }
   else{
	   $("#img0").hide();
   }
}
function getObjectURL(file) {
	var url = null ;
	if (window.createObjectURL!=undefined) { // basic
		url = window.createObjectURL(file) ;
	} else if (window.URL!=undefined) { // mozilla(firefox)
		url = window.URL.createObjectURL(file) ;
	} else if (window.webkitURL!=undefined) { // webkit or chrome
		url = window.webkitURL.createObjectURL(file) ;
	}
	return url ;
}


var subUrl = "";
$(function (){
	$(".file-3").bind('change',function(){
		subUrl = $(this).val()
		$(".yulan").show();
		$(".file-3").val("");
	});

	$(".file-3").each(function(){
		if($(this).val()==""){
			$(this).parents(".uploader").find(".filename").val("营业执照");
		}
	});
$(".btn-3").click(function(){
$("#img-1").attr("src", obUrl);
$(".yulan").hide();
$(".file-3").parents(".uploader").find(".filename").val(subUrl);
})
	$(".btn-2").click(function(){
		$(".yulan").hide();
	})

});
</script>
<script>
function setImagePreview() {
	var preview, img_txt, localImag, file_head = document.getElementById("file_head"),
			picture = file_head.value;
	if (!picture.match(/.jpg|.gif|.png|.bmp/i)) return alert("您上传的图片格式不正确，请重新选择！"),
			!1;
	if (preview = document.getElementById("preview"), file_head.files && file_head.files[0]) preview.style.display = "block",
			preview.style.width = "63px",
			preview.style.height = "63px",
			preview.src = window.navigator.userAgent.indexOf("Chrome") >= 1 || window.navigator.userAgent.indexOf("Safari") >= 1 ? window.webkitURL.createObjectURL(file_head.files[0]) : window.URL.createObjectURL(file_head.files[0]);
	else {
		file_head.select(),
				file_head.blur(),
				img_txt = document.selection.createRange().text,
				localImag = document.getElementById("localImag"),
				localImag.style.width = "63px",
				localImag.style.height = "63px";
		try {
			localImag.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale)",
					localImag.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src = img_txt
		} catch(f) {
			return alert("您上传的图片格式不正确，请重新选择！"),
					!1
		}
		preview.style.display = "none",
				document.selection.empty()
	}
	return document.getElementById("DivUp").style.display = "block",
			!0
}


/*$("#clipBtn").click(function(){
		if($("#sysfilename").val() != ""){
		    loading();
	        $("#crop_form").ajaxSubmit({
	            dataType:"json",
				data:{
					"imaPath":imaPath
				},
	            success: function(msg) {
	              	//var data="sysFileName=" + msg.name + "&filename=" + filename + "&imaPath=" + imaPath + "&path=" + path;
          			var fileStrJson = {"sysFileName": msg.name , "filename": filename, "imaPath": imaPath, "path": path};
		  			var tzParams = '{"ComID":"TZ_GD_ZS_USERMNG","PageID":"TZ_UP_PHOTO_STD","OperateType":"PHOTO","comParams":' + JSON.stringify( fileStrJson ) + '}';

	                $.ajax({
	                    type:"POST",
	                    url:TzUniversityContextPath + "/dispatcher",
						dataType:"json",
	                    data: {"tzParams" : tzParams },	
	                    beforeSend:function() {
	                        $(function(){
	                            $("#loading").fadeIn();
	                        });
	                    },
	                    success:function(html){
	                        if(html.comContent.success == "Y"){
	 							window.parent.$("#photox").attr("src", "%bind(:20)"+html.comContent.url);					
								window.SurveyBuild && window.parent.$("#photox").parent().parent().find('input[type="hidden"]').val(html.comContent.url);
	                            
								//layer.close(layer.index);
								$("#loading").fadeOut();
								closeThis();
	                        }else{
	                        	 //closeThis();
								 alert("%bind(:12)");
								 //layer.close(layer.index);
								 $("#loading").fadeOut();
							}
	                    },
			            error:function(xhr){
			                btn.html(xhr.responseText);
			                $("#loading").fadeOut();
							//layer.close(layer.index);
			            }
	                })
	            },
	            error:function(xhr){
	                btn.html(xhr.responseText);
					layer.close(layer.index);
	            }
	        });
		}else{
			alert("%bind(:13)");
		}
    });*/
</script>
</head>
	<body>
   <article class="htmleaf-container" style="display: block;">
		  <div id="clipArea" style="user-select: none; overflow: hidden; position: relative;"></div>
			<div class="foot-use">
				<div class="uploader1 blue">
					<input type="button" name="file" class="button" value="打开">
					<img id="tempimg" dynsrc="" style="display:none" />
					<!--form id="myupload" action="/ImaUploadServlet?sysfilename=" method="post" enctype="multipart/form-data"-->
					<form id="myupload"
						action="UpdWebServlet?filePath=zhglPhoto" method="post"
						enctype="multipart/form-data">
						<!-- <input class="fileupload2" type="file" name="websitefile" id="fileupload" style="position:absolute"/> -->
					
					    <!-- <input id="file" type="file" onchange="javascript:setImagePreview();" accept="image/*" multiple  /> -->
					
					<input id="file" name="websitefile" type="file"   />
					</form>
				</div>

				<button id="clipBtn">截取</button>
			</div>
            
			<div id="view" style="background-color: rgb(102, 102, 102); background-repeat: no-repeat; background-position: center center; background-size: contain;"></div>
			
	    </article>
	</body>
</html>